import "ecc/babyjubjubParams.code" as context
import "ecc/edwardsOnCurve.code" as onCurve
import "utils/pack/pack256.code" as pack
import "../circuits/ecAdd.code" as ecAdd
import "../circuits/ecMul.code" as ecMul
import "../circuits/constants/G.code" as G
import "../circuits/constants/H.code" as H
import "../circuits/safeAdd.code" as safeAdd
import "../circuits/pedersenCommitment.code" as pedersenCommitment
import "../circuits/challenge.code" as challenge
import "../circuits/transaction.code" as transaction


def testSafeAdd() -> (field):
  field result = safeAdd(1,2)
  result == 3
  // TODO Add error case tests
  // Currently, ZoKrates does not support test tool for assertion error
  return 1

def testECMul() -> (field):
  field[2] G = G()
  field[2] H = H()
  context = context()
  field[2] rG1 = ecMul(1,G)
  field[2] rG2 = ecMul(2,G)
  field[2] vH1 = ecMul(3,H)
  field[2] vH2 = ecMul(4,H)
  1 == onCurve(rG1, context)
  1 == onCurve(rG2, context)
  1 == onCurve(vH1, context)
  1 == onCurve(vH2, context)
  return 1

def testPedersenCommitment() -> (field):
  context = context()
  field[2] pedersen1 = pedersenCommitment(1, 2)
  field[2] pedersen2 = pedersenCommitment(3, 8)
  1 == onCurve(pedersen1, context)
  1 == onCurve(pedersen2, context)
  return 1

def testChallenge() -> (field):
  field challenge1 = pack(challenge([1,2], [3,4], 5, 6))
  field challenge2 = pack(challenge([1,2], [3,4], 5, 7))
  return if challenge1 == challenge2 then 0 else 1 fi

def testTransaction() ->(field):
  // Generated sample data with pycrypto
  return 1

def main() -> (field[2]):
  // 1 == testSafeAdd()
  // 1 == testECMul()
  // 1 == testPedersenCommitment()
  // 1 == testCreateChallenge()
  // 1 == testTransaction()
  field a = 3
  field b = 8 - 3
  //return ecAdd(ecMul(a, G()), ecMul(b, G()))
  return [1,3]
